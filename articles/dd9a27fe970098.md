---
title: "<Card.Root> ã®ã‚ˆã†ã«å®Ÿè£…ã™ã¹ããªã®ã‹"
emoji: "ğŸ“‘"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [react, reactservercomponents, javascript, typescript, webperfomance, webdevelopment]
published: true 
---
## ã¯ã˜ã‚ã«
`<Card.Root>`ã®ã‚ˆã†ãªè¨˜è¿°ã‚’è¦‹ã‹ã‘ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã§ã™ãŒReact Server Component(ä»¥ä¸‹ã€RSCã¨ã„ã†)ã®æ–‡è„ˆã§ã¯ã€`<Card.Root>` ã®ã‚ˆã†ãªè¨˜è¿°ã¯é¿ã‘ã‚‹ã¹ãã¨ã•ã‚Œã¦ã„ã¾ã™ã€‚ãªãœã§ã—ã‚‡ã†ã‹ã€‚

`<Card.Root>`ã¯"dot"ã‚’ä½¿ç”¨ã—ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ–¹æ³•ã‚’æŒ‡ã—ã¾ã™ã€‚dot notationã¨å‘¼ã°ã‚Œã‚‹è¨˜æ³•ã§ã™ã€‚dot notationã«é–¢ã™ã‚‹issueã‚’è¦‹ã‹ã‘ãŸã®ã§ã€ä½•ãŒèµ·ãã¦ã„ã‚‹ã®ã‹ã‚’èª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚

## ä»£è¡¨çš„ãªdot notationã®ä¾‹
ä¾‹ãˆã°ã€React Contextã‚’ä½¿ã£ãŸã¨ãã€`ThemeContext`ã¨ã„ã†ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚ã‚Šã€ãã‚Œã«é–¢é€£ã™ã‚‹ `Provider`ã¨ã„ã†ã‚µãƒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒ`ThemeContext.Provider`ã®ã‚ˆã†ã«dotè¡¨è¨˜ã§å‚ç…§ã•ã‚Œã‚‹ã®ã§ã™ã€‚
```jsx
import { createContext, useContext } from 'react';

const Theme = createContext(null);

function App({ children }) {
    return (
        <ThemeContext.Provider value="dark">
            {children}
        </ThemeContext.Provider>
    );
}

function Header() {
    const theme = useContext(Theme);
    return <header style={{ color: theme === 'dark' ? 'white' : 'black' }}>Header</header>;
}
```

## dot notationã§å®Ÿè£…ã‚’ã™ã‚‹ã¨ä½•ãŒèµ·ã“ã‚‹ã®ã‹
dot notationã§å®Ÿè£…ã‚’ã™ã‚‹ã¨ã€RSCã®æ–‡è„ˆã§å•é¡ŒãŒç™ºç”Ÿã—ã¾ã™ã€‚
ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹ã¨ã—ã¾ã™ã€‚

```jsx:components/card.tsx
function Card() {}

Card.Header = function Header() {}
Card.Body = function Body() {}
Card.Footer = function Footer() {}

export default Card;
```

```jsx:example/card.tsx
import { Card } from "../components/card"

export const BasedCard = () => {
    return (
        <Card>
            <Card.Body>
            </Card.Body>
            <Card.Footer justifyContent="flex-end" gap="2">
            </Card.Footer>
        </Card>
    )
}
```
ã“ã®ã¨ãã€ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã®å•é¡ŒãŒç™ºç”Ÿã—ã¾ã™ã€‚é–¢æ•°ã¯JSONã«ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã§ããªã„ãŸã‚ã€RSCã¨äº’æ›æ€§ãŒã‚ã‚Šã¾ã›ã‚“ï¼ˆã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã§ãã‚‹ã®ã¯ã€"div" ãªã©ã®åŸºæœ¬çš„ãªHTMLã‚¿ã‚°ã‚’å«ã‚“ã ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã€‚ãã®ãŸã‚ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã§ã—ã‚‡ã†ã€‚
https://github.com/facebook/react/blob/473522093d3dd95582729d01cd5c0d15dcc9cd3b/packages/react-server-dom-webpack/src/ReactFlightWebpackReferences.js#L188-L192

ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã®å•é¡ŒãŒç™ºç”Ÿã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®issueã§è­°è«–ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚
- ["Dot notation client component breaks consuming RSC"](https://github.com/vercel/next.js/issues/51593)
- ["This is probably a bug in the React Server Components bundler"](https://github.com/vercel/next.js/issues/58776)

### RSCã®æ–‡è„ˆã§dot notationã‚’ã™ã‚‹ä»£æ›¿æ¡ˆ
RSCã®æ–‡è„ˆã§ã¯é–¢æ•°ã¯ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã§ããªã„ãŸã‚ã€`Card`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦exportã—ã¾ã™(`export * as Card`)ã€‚

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’named exportã™ã‚Œã°ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ¬ãƒ™ãƒ«ã§tree shakingã—ã‚„ã™ã„ã§ã—ã‚‡ã†ã€‚
https://github.com/chakra-ui/chakra-ui/blob/d4f9d312da0144c081cdb48021bc6396f3290bc6/packages/react/src/components/card/card.tsx#L30-L33

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’re-exportã™ã‚‹ã¨ãã«ã€aliasã‚’ä½¿ã†ã“ã¨ã§ã€tree-shakingã‚’ä¿ã¡ãªãŒã‚‰ã€å‘½åã‚’ç°¡æ½”ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
https://github.com/chakra-ui/chakra-ui/blob/d4f9d312da0144c081cdb48021bc6396f3290bc6/packages/react/src/components/card/namespace.ts#L1-L9

https://github.com/chakra-ui/chakra-ui/blob/d4f9d312da0144c081cdb48021bc6396f3290bc6/packages/react/src/components/card/index.ts#L21

re-export, index.ts(Barrel file), namespace import ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«æŠµæŠ—æ„Ÿã‚’æŒã¤äººã‚‚ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚Preactã®ãƒ¡ãƒ³ãƒãƒ¼ã§ã‚ã‚‹Marvin Hagemeisterã®è¨˜äº‹ ["Speeding up the JavaScript ecosystem - The barrel file debacle"](https://marvinh.dev/blog/speeding-up-javascript-ecosystem-part-7/) ã§ã‚‚ã€ãƒ‡ãƒ¡ãƒªãƒƒãƒˆãŒè¿°ã¹ã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚

>  In a real project these numbers are likely worse. Barrel files are not good when it comes to tooling performance. 

re-exportã‚’ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ•°ãŒå¢—åŠ ã™ã‚‹ã¨ãƒãƒ³ãƒ‰ãƒ«ã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã‚‚å¢—åŠ ã—ãã†ã§ã™ã€‚ä¸Šè¨˜ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«å¯¾ã—ã¦ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’æŒ™ã’ã¦ãã¾ã—ãŸãŒã€å€‹äººçš„ã«ã¯ã€ä¸å¯§ã«è‰¯ãæ›¸ã‹ã‚ŒãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯re-exportã•ã‚Œã¦ã‚‚tree-shakingã•ã‚Œã‚‹ã¨è€ƒãˆã¦ã„ã¦ã€re-exportã•ã‚ŒãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ã†ã“ã¨ã«æŠµæŠ—æ„Ÿã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

ã§ã™ãŒã€dot notationã‚’ä½¿ç”¨ã™ã‚‹ã¨ãã®æ¬ ç‚¹ãªã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä¸€éƒ¨ã ã‘ã‚’importã—ãŸã„ã¨ãã¯ã€`CardRoot`ã‚’ç›´æ¥importã™ã‚‹ã“ã¨ã‚’å¼·ãæ¨å¥¨ã•ã‚Œã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚
```jsx
import { CardRoot, CardBody } from "@/components/ui/card";

export function App() {
return (
    <CardRoot>
        <CardBody>BODY</CardBody>
    </CardRoot>
    );
}
```

ä½™è«‡ã¨ã—ã¦Biomeã§ã¯ã€ä»¥ä¸‹ã®ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚Œã°ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºã‚’æŠ‘ãˆã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
- [noBarrelFile (since v1.6.0) | Biome](https://biomejs.dev/linter/rules/no-barrel-file/)
- [noReExportAll (since v1.6.0) | Biome](https://biomejs.dev/linter/rules/no-re-export-all/)
- [noNamespaceImport (since v1.6.0) | Biome](https://biomejs.dev/linter/rules/no-namespace-import/)